function filterTags(e){e=[parseInt(e.find(":selected").attr("value"))];$.ajax({type:"GET",url:"/Item/GetThemeTags",data:{ids:e},dataType:"json",cache:!1,traditional:!0,success:function(e){$("#checkboxes label").hide();for(var t=0;t<e.length;t++)$("#tag-input-id-"+e[t]).parent().show()},error:function(){alert("Error occured!!")}})}function filterProjects(e){e=[parseInt(e.find(":selected").attr("value"))];$.ajax({type:"GET",url:"/Item/GetTeamProjects",data:{ids:e},dataType:"json",cache:!1,traditional:!0,success:function(e){$("#project-selector option:not(:first)").hide();for(var t=0;t<e.length;t++)$("#project-selector option[value="+e[t]+"]").show()},error:function(){alert("Error occured!!")}})}$(document).ready(function(){$(":checkbox").change(function(){$(this).is(":checked")?$(this).attr("checked",!0):$(this).attr("checked",!1)}),filterTags($("#theme-selector")),filterProjects($("#team-selector")),$("#theme-selector").change(function(){filterTags($(this))}),$("#team-selector").change(function(){filterProjects($(this))})});var expanded=!1;function showCheckboxes(){var e;0==$("#tag-selector select").prop("disabled")&&(e=document.getElementById("checkboxes"),expanded=expanded?!(e.style.display="none"):(e.style.display="block",!0))}function addKeyInsightField(e){var t=$(e).parent().find(".key-insight-field").length;const a=$(e).parent();a.append(`<div class="key-insight-field row">
                        <div class="col-12">
                            <label for="KeyInsightsList_${t}_">KeyInsightsList[${t}]</label>
                        </div>
                        <div class="col-10" data-children-count="1">
                            <input class="form-control" type="text" id="KeyInsightsList_${t}_" name="KeyInsightsList[${t}]" value="">
                            <span class="text-danger field-validation-valid" data-valmsg-for="KeyInsightsList[${t}]" data-valmsg-replace="true"></span>
                        </div>
                        <div class="col-2"><button onclick="removeField(this, 'keyInsight')">Delete</button></div>
                    </div>`),event.preventDefault()}function addSuggestedTagField(e){var t=$(e).parent().find(".suggested-tag-field").length;const a=$(e).parent();a.append(`<div class="suggested-tag-field row">
                                <div class="col-12">
                                    <label for="SuggestedTagList_${t}_">SuggestedTagList[${t}]</label>
                                </div>
                                <div class="col-10" data-children-count="1">
                                    <input class="form-control" type="text" id="SuggestedTagList_${t}_" name="SuggestedTagList[${t}]" value="">
                                    <span class="text-danger field-validation-valid" data-valmsg-for="SuggestedTagList[${t}]" data-valmsg-replace="true"></span>
                                </div>
                                <div class="col-2"><button onclick="removeField(this, 'suggestedTag')">Delete</button></div>
                            </div>`),0==t&&(e.innerHTML="Suggest another tag"),event.preventDefault()}function showField(e,t){$("#"+t).show(),$(e).hide(),event.preventDefault()}function removeField(e,t){$(e).parent().parent().remove(),"suggestedTag"==t&&0==$(".suggested-tag-field").length&&$("#add-suggested-tag-button").html("Suggest a tag"),event.preventDefault()}function hideField(e,t){$("#"+e+" input").val(""),$("#"+e).hide(),$("#"+t).show(),event.preventDefault()}function handleFiles(e){for(var t=e.files,a=new FormData,i=0;i<t.length;i++)a.append(t[i].name,t[i]);$.ajax({url:"/Item/PostFiles",cache:!1,contentType:!1,processData:!1,data:a,type:"post",success:function(e){var t=$("#file-names").val()+e;if($("#file-names").val(t),e){let t=e.split(",");t.pop();let a="";for(let e=0;e<t.length;e++){var i="/Item/GetDownloadedFile/?filePath=\\files\\documents\\items\\temp\\"+t[e];a+=`<div class="file"><a href="${i}"><h2>${t[e]}</h2></a><button onclick="removeFile(this)">Delete</button><br><br></div>`}$("#files-list").append(a)}},error:function(e){console.log(e),alert("An error occurred!!!")}}),event.preventDefault()}function removeFile(e){const t=$(e).parent().find("h2").first().text();$.ajax({url:"/Item/DeleteFiles",contentType:"application/json; charset=utf-8",data:{name:t},type:"GET",cache:!1,success:function(){var e=$("#file-names").val().replace(t+",","");$("#file-names").val(e),console.log($("#file-names").val())},error:function(e){console.log(e),alert("An error occurred!!!")}}),$(e).parent().remove(),event.preventDefault()}function filterProfileItems(e){$(".item").hide(),$(`.item[data-status='${e}']`).show(),$(".selected").removeClass("selected"),$(this).addClass("selected")}function getTeams(){let s=[];return $(".team").each(function(e,t){let a=[];const i=$(t).find(".team-id").first().val();var n=$(t).find(".team-name-input").first().val();$(t).find(".project").each(function(e,t){t={Id:$(t).find(".project-id").first().val(),Name:$(t).find(".project-name-input").first().val(),TeamId:i};a.push(t)});n={Id:i,Name:n,Projects:a};s.push(n)}),s}function saveTempTeams(e,i){e=JSON.stringify(e);$.ajax({type:"POST",url:"/Team/SaveTeamsState",traditional:!0,data:e,contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){var a=$("#project-teamId-modal-input");$("#project-teamId-modal-input option:gt(0)").remove();for(let e=0;e<t.length;e++)a.append($("<option></option>").attr("value",t[e].value).text(t[e].text));$("#project-teamId-modal-input").val(i)},error:function(e){console.log(e),alert("An error occurred!!!")}})}function updateProjects(e){const t=e.closest(".project-modal");var a=t.find("#project-id-modal-input").first().val();const i=t.find("#project-teamId-modal-input").find(":selected").attr("value");var n=t.find("#project-oldTeamId-modal-input").val(),s=t.find("#project-name-modal-input").first().val(),e=e.val();$.ajax({type:"GET",url:"/Project/UpdateProject",data:{id:a,projectName:s,teamId:i,oldTeamId:n,actionName:e},contentType:"application/json; charset=utf-8",success:function(e){updateTeamProjects(i)},error:function(e){console.log(e),alert("An error occurred!!!")}})}function updateTeamProjects(){window.location.replace("../team?redirect=True")}function openProjectModal(e){$("#project-delete-button").show().prop("disabled",!1),$("#project-submit-button").val("Update");var t=$(e).siblings(".project-name-input").first().val();console.log(e);var a=$(e).siblings(".project-id").first().val(),i=$(e).closest(".team").find(".team-id").first().val();$(e).siblings("#project-oldTeamId-modal-input").first().val();$("#project-name-modal-input").attr("value",t),$("#project-id-modal-input").attr("value",a),$("#project-teamId-modal-input").val(i),$("#project-oldTeamId-modal-input").val(i),$("#myProjectModal").show(),saveTempTeams(getTeams(),i),event.preventDefault()}function openAddProjectModal(e){console.log("kk"),$("#project-delete-button").hide().prop("disabled",!0),$("#project-submit-button").val("Add");var t=$(e).closest(".team").find(".team-id").first().val();$(e).siblings("#project-oldTeamId-modal-input").first().val();$("#project-teamId-modal-input").val(t),$("#project-oldTeamId-modal-input").val(t),$("#project-id-modal-input").attr("value",0),$("#project-name-modal-input").attr("value",""),$("#myProjectModal").show(),saveTempTeams(getTeams(),t)}function setNotificationValue(){$.ajax({url:"/Item/AddNotificationsToSession",type:"GET",dataType:"json",success:function(e){let a=[],i=[],n=[];e.forEach(function(e,t){"Draft"==e?a.push(e):"Published"==e?i.push(e):"Rejected"==e&&n.push(e)}),a.length&&$("#profile-draft-notification").html("!"),i.length&&$("#profile-published-notification").html("!"),n.length&&$("#profile-rejected-notification").html("!"),e.length&&$("#item-notification-count").html("!")},error:function(e,t){alert("Request: "+JSON.stringify(e))}})}function setItemRequestValue(){$.ajax({url:"/Item/AddItemRequestCountToSession",type:"GET",dataType:"json",success:function(e){$("#item-request-count").html(e)},error:function(e,t){alert("Request: "+JSON.stringify(e))}})}$(document).ready(function(){$("#file-upload-box").change(function(){handleFiles(this)}),null!=$("#theme-selector").val()&&0!=$("#theme-selector").val()&&$("#tag-selector select").prop("disabled",!1),$("#team-selector").val()&&$("#project-selector").prop("disabled",!1),$("#team-selector").change(function(){0!=$(this).val()&&($("#project-selector").prop("selectedIndex",0),$("#project-selector").prop("disabled",!1))}),$("#theme-selector").change(function(){0!=$(this).val()&&$("#tag-selector select").prop("disabled",!1)}),$("#status-selector").change(function(){"Rejected"==$(this).val()?$("#comment-input").show():$("#comment-input").hide()})}),$(document).ready(function(){$("#profile-edit-btn").click(function(){event.preventDefault(),$("#profile-save-btn").show(),$("#user-role-input").show(),$("#user-name-input").show(),$("#user-team-selector").show(),$("#user-name-text").hide(),$("#user-team-text").hide(),$("#user-role-text").hide(),$(this).hide()}),$(".selected").first().click()}),$(document).ready(function(){$(".projectModalClose").click(function(){$("#myProjectModal").hide()}),$(".project-modal-btn").click(function(){updateProjects($(this))}),$(document).mouseup(function(e){const t=$("#myProjectModal");t.is(":visible")&&t.is(e.target)&&0===t.has(e.target).length&&(t.hide(),$("#project-name-input").val(""))})}),$(document).ready(function(){setNotificationValue(),$(".item-request-link").length&&setItemRequestValue()});let queryParameters={searchText:searchText="",themes:themes=[],teams:teams=[],projects:projects=[],tags:tags=[],sensitivity:sensitivity=[],approvals:approvals=[],status:status=["Published"],userIds:userIds=[],startDate:startDate="0001-01-01",endDate:endDate="0001-01-01",paginationStartItem:paginationStartItem="0"};const numOfItemsPerPage=1;function updateFilterParameters(e,t){if(queryParameters.themes=[],queryParameters.teams=[],queryParameters.projects=[],queryParameters.tags=[],queryParameters.sensitivity=[],queryParameters.approvals=[],$("#approval-checkbox-filter input:visible:checked").each(function(e,t){queryParameters.approvals.push($(this).data("name"))}),$("#sensitivity-checkbox-filter input:visible:checked").each(function(e,t){queryParameters.sensitivity.push($(this).data("name"))}),$("#tag-checkbox-filter input:visible:checked").each(function(e,t){queryParameters.tags.push($(this).data("name"))}),$("#team-checkbox-filter input:visible:checked").each(function(e,t){queryParameters.teams.push($(this).data("name"))}),$("#theme-checkbox-filter input:visible:checked").each(function(e,t){queryParameters.themes.push($(this).data("name"))}),$("#project-checkbox-filter input:visible:checked").each(function(e,t){queryParameters.projects.push($(this).data("name"))}),$("#start-date-search").length&&(queryParameters.startDate=$("#start-date-search").val()),$("#end-date-search").length)queryParameters.endDate=$("#end-date-search").val();else{let e=new Date;var a=e.getTimezoneOffset();e=new Date(e.getTime()-60*a*1e3),queryParameters.endDate=e.toISOString().split("T")[0]}queryParameters.paginationStartItem=e*numOfItemsPerPage,t&&(queryParameters.status=[],queryParameters.status.push(t)),filterItemList(t,e)}function filterItemList(s,r){var e=JSON.stringify(queryParameters);$.ajax({type:"GET",url:"/Item/GetFilteredItems",data:{itemQueryJson:e},success:function(t){let a="";for(let e=0;e<t.items.length;e++)$("#filters.profile-filters").length&&(a+=`<tr>
                    <td width="33%">${t.items[e].title}</td>
                    <td width="33%">${t.items[e].team}</td>
                    <td width="33%">${t.items[e].abstract}</td>
                    <td class="text-center">
                        <div class="w-75 btn-group" role="group">
                            <a class="btn btn-primary mx-2" href="/Item/Upsert/${t.items[e].id}">
                                View${"Submitted"!=s&&t.items[e].notifyUploader?"!":""}
                            </a>
                        </div>
                    </td>
                </tr>`),$("#filters.librarian-filters").length&&(a+=`<tr>
                    <td width="33%">${t.items[e].title}</td>
                    <td width="33%">${t.items[e].team}</td>
                    <td width="33%">${t.items[e].abstract}</td>
                    <td class="text-center">
                        <div class="w-75 btn-group" role="group">
                            <a class="btn btn-primary mx-2" href="/Item/Upsert/${t.items[e].id}">
                                View
                            </a>
                        </div>
                    </td>
                </tr>`),$("#filters.published-filters").length&&(a+=`<tr>
                    <td width="33%">${t.items[e].title}</td>
                    <td width="33%">${t.items[e].team}</td>
                    <td width="33%">${t.items[e].abstract}</td>
                    <td class="text-center">
                        <div class="w-75 btn-group" role="group">
                            <a class="btn btn-primary mx-2" href="/Item/View/${t.items[e].id}">
                                View
                            </a>
                        </div>
                    </td>
                </tr>`);$("#item-list").html(a);let i="",n=0;if(n=t.numOfTotalResults<=numOfItemsPerPage?0:Math.ceil(t.numOfTotalResults/numOfItemsPerPage)-1,i+=1<=r?`<button class="pagination-item" onclick="updateFilterParameters(${r-1}, '${s}')">&#60;Prev</button>`:`<button class="pagination-item" onclick="updateFilterParameters(${r-1}, '${s}')" disabled>&#60;Prev</button>`,i+=`<button class="pagination-item" onclick="updateFilterParameters(0, '${s}')">1</button>`,2<r&&(i+='<button class="pagination-item">...</button>'),console.log(r),r<=1)for(let e=r;e<=3;e++)0<e&&(i+=`<button class="pagination-item" onclick="updateFilterParameters(${e}, '${s}')">${e+1}</button>`);else for(let e=r-1;e<=r+1;e++)0<e&&e!=n&&(i+=`<button class="pagination-item" onclick="updateFilterParameters(${e}, '${s}')">${e+1}</button>`);r<t.numOfTotalResults-3&&(i+='<button class="pagination-item">...</button>'),i+=`<button class="pagination-item" onclick="updateFilterParameters(${n}, '${s}')">${n+1}</button>`,r<n?i+=`<button class="pagination-item" onclick="updateFilterParameters(${r+1}, '${s}')">Next&#62;</button>`:i+=`<button class="pagination-item" onclick="updateFilterParameters(${r+1}, '${s}')" disabled>Next&#62;</button>`,$("#item-list-pagination").html(i)},error:function(){alert("Error occured!!")}})}function filterTagsForItemsList(){let a=[];$("#theme-checkbox-filter input:checked:visible").each(function(e,t){a.push($(this).parent().next("input").val())}),$.ajax({type:"GET",url:"/Item/GetThemeTags",data:{ids:a},dataType:"json",cache:!1,traditional:!0,success:function(e){if(void 0!==a&&0<a.length){$("#tag-checkbox-filter label").hide();for(var t=0;t<e.length;t++)$("#tag-input-id-"+e[t]).parent().show()}else $("#tag-checkbox-filter label").show();updateFilterParameters(queryParameters.paginationStartItem,"Published")},error:function(){alert("Error occured!!")}})}function filterProjectsForItemsList(){let a=[];$("#team-checkbox-filter input:checked:visible").each(function(e,t){a.push($(this).parent().next("input").val())}),$.ajax({type:"GET",url:"/Item/GetTeamProjects",data:{ids:a},dataType:"json",cache:!1,traditional:!0,success:function(e){if(void 0!==a&&0<a.length){$("#project-checkbox-filter label").hide();for(var t=0;t<e.length;t++)$("#project-input-id-"+e[t]).parent().show()}else $("#project-checkbox-filter label").show();filterTagsForItemsList()},error:function(){alert("Error occured!!")}})}function getThemes(){let i=[];return $(".theme").each(function(e,t){let n=[],s=[];var a={Id:$(t).find(".theme-id").first().val(),Name:$(t).find(".theme-name-input").first().val(),Image:""};$(t).find(".tag-checkbox").each(function(e,t){var a=$(t).find(".tag-checkbox-id").first().val(),i=$(t).find(".tag-checkbox-name").first().val(),t={Value:a,Name:i,CheckedState:$(t).find(".tag-checkbox-state").first().is(":checked")};n.push(t);a={Text:i,Value:a};s.push(a)});a={Theme:a,TagCheckboxes:n,TagSelectList:s};i.push(a)}),console.log(i),i}function saveTempThemes(e){e=JSON.stringify(e);$.ajax({type:"POST",url:"/Theme/SaveThemesState",traditional:!0,data:e,contentType:"application/json; charset=utf-8",dataType:"json"})}function populateTagNameField(e){let t=parseInt(e.find(":selected").attr("value"));"newTag"==t&&(t=null),$.ajax({type:"GET",url:"/Tag/GetTagName",data:{id:t},contentType:"application/json; charset=utf-8",success:function(e){"newTag"==e?($("#tag-name-input").val(""),$("#tag-submit-button").val("Add"),$("#tag-delete-button").hide(),$("#tag-delete-button").prop("disabled",!0)):($("#tag-name-input").val(e),$("#tag-submit-button").val("Update"),$("#tag-delete-button").show(),$("#tag-delete-button").prop("disabled",!1)),$("#tag-name-input").show(),$("#tag-submit-button").show(),$("#tag-submit-button").prop("disabled",!1)},error:function(e){console.log(e),alert("An error occurred!!!")}})}function updateTags(e){let t=e.closest(".modal-content").find("#tag-select-dropdown").first().find(":selected").attr("value");t="newTag"==t?0:parseInt(t);var a=e.closest(".modal-content").find("#tag-name-input").first().val(),e=e.val();$("#tag-select-dropdown").val(0),$("#tag-name-input").val(""),$.ajax({type:"GET",url:"/Tag/UpdateTag",data:{id:t,tagName:a,actionName:e},contentType:"application/json; charset=utf-8",success:function(t){var a=$("#tag-select-dropdown");$("#tag-select-dropdown option:gt(1)").remove();for(let e=0;e<t.length;e++)a.append($("<option></option>").attr("value",t[e].id).text(t[e].name))},error:function(e){console.log(e),alert("An error occurred!!!")}})}function updateThemeTags(){window.location.replace("../theme?redirect=True")}function editName(e,t){event.preventDefault(),$(e).siblings(`.${t}-name-input`).show(),$(e).siblings(`.apply-${t}-name-btn`).show(),$(e).siblings(`.${t}-name-text`).hide(),$(e).hide(),console.log(`.${t}-name-input`)}function applyName(e,t){event.preventDefault();var a=$(e).siblings(`.${t}-name-input`).val();$(e).siblings(`.${t}-name-text`).html(a),$(e).siblings(`.${t}-name-text`).show(),$(e).siblings(`.edit-${t}-name-btn`).show(),$(e).siblings(`.${t}-name-input`).hide(),$(e).hide(),console.log(`.${t}-name-input`)}$(document).ready(function(){$("#filters input:not(#text-search), #filters select").change(function(){filterProjectsForItemsList()}),$("#filters #text-search, #filters #start-date-search, #filters #end-date-search").keyup(function(){queryParameters.searchText=$("#text-search").val(),filterProjectsForItemsList()}),$("#filters.published-filters").length&&updateFilterParameters(queryParameters.paginationStartItem,"Published"),$("#filters.librarian-filters").length&&updateFilterParameters(queryParameters.paginationStartItem,"Submitted"),$("#filters.profile-filters").length&&($.ajax({type:"GET",url:"/Profile/GetUserId",dataType:"text",success:function(e){queryParameters.userId=[],queryParameters.userId.push(e),console.log(e)},error:function(){alert("Error occured!!")}}),updateFilterParameters(queryParameters.paginationStartItem,"Draft"))}),$(document).ready(function(){$("#myTagBtn").click(function(){event.preventDefault(),$("#tag-name-input").hide(),$("#tag-delete-button").hide(),$("#tag-submit-button").hide(),$("#tag-delete-button").prop("disabled",!0),$("#tag-submit-button").prop("disabled",!0),$("#myTagModal").show(),saveTempThemes(getThemes())}),$(".tagModalClose").click(function(){$("#myTagModal").hide(),$("#tag-name-input").val(""),$("#tag-name-input").hide(),$("#tag-select-dropdown").val(0),$("#tag-delete-button").hide(),$("#tag-submit-button").hide(),$("#tag-delete-button").prop("disabled",!0),$("#tag-submit-button").prop("disabled",!0),updateThemeTags()}),$(document).mouseup(function(e){const t=$("#myTagModal");t.is(":visible")&&t.is(e.target)&&0===t.has(e.target).length&&(t.hide(),$("#tag-name-input").val(""),$("#tag-name-input").hide(),$("#tag-select-dropdown").val(0),$("#tag-delete-button").hide(),$("#tag-submit-button").hide(),$("#tag-delete-button").prop("disabled",!0),$("#tag-submit-button").prop("disabled",!0),updateThemeTags())}),$("#tag-select-dropdown").change(function(){populateTagNameField($(this))}),$(".tag-modal-btn").click(function(){updateTags($(this))})});